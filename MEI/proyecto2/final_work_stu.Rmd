---
title: | 
  | SME. Final work 
  |
  | Inferential Statistics.
  |
  | Sampling distributions and confidence intervals
  |
  |
author: '**Name:** Jon Echevarria Sasia '
date: |
  |
  | `r Sys.setlocale("LC_TIME", "C");format(Sys.Date(), "%B %d, %Y")`
  |
  | Table of contents
  |
output:
  pdf_document:
    toc: yes
    toc_depth: '4'
    keep_tex: true
  html_document:
    highlight: espresso
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 4
---




```{r setup, include=FALSE, echo=FALSE}
# setting the options

knitr::opts_chunk$set(echo = TRUE)
options() # printing all current options
options(digits = 2) # number of digits to display

library(moments)   # needed for finding the third and fourth  moments
# Intall if not already installed

```

>     

  
\newpage

# Introduction

> In this laboratory you will have a statement and you have to solve it using R, Rmarkdown and LaTeX. 

> All the necessary formulas will we written in LaTeX. And the answers will written using the R and Rmarkdown commands required. *$(FORMULA = OUTPUT\  FROM\  CODE)$*

> You have to follow the index given and add the explanations required.

\vspace{2cm}

# The statement

> An industrial engineer has designed a machine to pack three-pound potato bags.
However, due to various reasons, such as different weights of potatoes,
filling problems, etc. is aware that the final weight of the potato bag won`t 
be exactly three kilos, but there will be random variations in this quantity.



\vspace{2cm}

## Read the  data and describe them

> 1. The data of the sample comes in the following file: *potato_bags.csv*


```{r, eval=FALSE,echo=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.

# Read the data
fileName <- "potato_bags.csv"
DataX <- read.table(fileName, header = TRUE, col.names = c("X.sample"))

# Number of observations
num_observations <- nrow(DataX)

# Number of variables
num_variables <- ncol(DataX)

# Display answers
cat("How many data are in the file? ", num_observations, "\n")
cat("How many variables? ", num_variables, "\n")


```

**QUESTIONS**

> How many data are in the fille?
45
> How many variables? 
1
>  






> 2. Find the mean, variance, standard deviation of the data in the sample

>   


```{r echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Find the mean, variance, standard deviation of the data in the sample
mean_X <- mean(DataX$X.sample)
variance_X <- var(DataX$X.sample)
std_dev_X <- sd(DataX$X.sample)

# Display answers
cat("The mean of the sample is $\\bar{x} = ", mean_X, "$\n")
cat("The variance is $\\sigma^{2} = ", variance_X, "$\n")
cat("The standard deviation is $\\sigma = ", std_dev_X, "$\n")

```


> The mean of the sample is *$\bar{x} = FORMULA = 3.08$*,

> the variance is *$\sigma^{2} = FORMULA = 0.03$*,

> and the standard deviation is *$\sigma = FORMULA = 0.18$*.

>    

> 3. Draw the histogram of the data showing the density not the frequencies.

```{r echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Draw the histogram of the data showing the density not the frequencies.
hist(DataX$X.sample, prob = TRUE, col = "lightblue", main = "Histogram of Potato Bag Weights", xlab = "Weight")
lines(density(DataX$X.sample), col = "red", lwd = 2)
*****************************error

```


\newpage

# Sampling distribution of the Sample Mean $X_{n}$


> Find the expected value of the Sample Mean and its standard error.

```{r echo=FALSE,eval=FALSE}

mean_sample_mean <- mean_X
se_sample_mean <- std_dev_X / sqrt(num_observations)

# Display answers
cat("Expected value of the Sample Mean: $E[X_{n}] = ", mean_sample_mean, "$\n")
cat("Standard error of the Sample Mean: $SD(X_{n}) = ", se_sample_mean, "$\n")

```

>> *$E[X_{n}] = FORMULA = 3.08$*


>> and standard error *$SD(X_{n}) = FORMULA = 0.03$* 

\vspace{2cm}

> Which distribution follows the Sample Mean and why? 

**ANSWER:**  
\vspace{2cm}
>The sampling distribution of the sample mean follows a normal distribution. This is based on the Central Limit Theorem, which states that the distribution of the sample mean approaches a normal distribution as the sample size increases.

\vspace{2cm}

> Draw the curve supposing the original population has mean $\mu = 3$ and $\sigma = 0.2$.  





```{r echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Draw the curve supposing the original population has mean μ = 3 and σ = 0.2.
mu <- 3
sigma <- 0.2
x <- seq(mu - 3*sigma, mu + 3*sigma, length.out = 100)
y <- dnorm(x, mean = mu, sd = sigma)

plot(x, y, type = "l", col = "blue", lwd = 2, xlab = "Weight", ylab = "Density", main = "Sampling Distribution of the Sample Mean")


```

\newpage
# Confidence interval for the mean
>1. Which distribution do you use for finding the probability of the confidence interval? Write the  formula for the scores.

**ANSWER:**  
\vspace{2cm}
We use the t-distribution to find the probability of the confidence interval. The formula for the t-scores is:

$t = \frac{\bar{x}-\mu}{\frac{s}{\sqrt{n}}}$






>2. Find the corresponding quantiles using that distribution.


**ANSWER:** 
\vspace{2cm}

```{r, eval=FALSE,echo=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate quantiles
confidence_level <- 0.95
alpha <- 1 - confidence_level
q <- qt(1 - alpha/2, df = num_observations - 1)

```


>The value of the quantile corresponding to the significance level is $q =2.015368$

> 3. And draw it in the graphic of the distribution.


```{r, echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Draw the distribution with the confidence interval
x <- seq(mu - 3*sigma, mu + 3*sigma, length.out = 100)
y <- dt(x, df = num_observations - 1)

# Draw the histogram of the data showing the density not the frequencies.
hist(DataX$X.sample, prob = TRUE, col = "lightblue", main = "Histogram of Potato Bag Weights", xlab = "Weight")

# Add density line
lines(density(DataX$X.sample), col = "red", lwd = 2)

# Add confidence interval lines
abline(v = c(mean_X - q * se_sample_mean, mean_X + q * se_sample_mean), col = "blue", lty = 2, lwd = 2)

```





\vspace{2cm}
>3. Find the margin of error and the bounds of the interval.

**ANSWER:** 
\vspace{2cm}

```{r echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate margin of error and interval bounds
margin_of_error <- q * se_sample_mean
lower_bound <- mean_sample_mean - margin_of_error
upper_bound <- mean_sample_mean + margin_of_error

# Display answers
cat("The margin of error is $", margin_of_error, "$\n")
cat("The bounds of the interval for the mean: ($", lower_bound, ", $", upper_bound, ")\n")


```


> The margin of error is $0.067$

> The bounds of the interval for the mean: $(3.013,3.147)$

\newpage
# Test the following hypothesis

> To check if the machine is well calibrated, take a sample of 45 bags filled with potatoes and count their weight. With this information, 

>> Does the engineer have reason to think the machine is poorly calibrated? (Please use 5% signication level).


## Design the test 


```{r echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Design the hypothesis test
sample_size <- 45
sample_mean <- mean(DataX$X.sample)
sample_sd <- sd(DataX$X.sample)

# Define hypotheses
null_hypothesis <- "The machine is well calibrated."
alternative_hypothesis <- "The machine is poorly calibrated."
significance_level <- 0.05

# Display answers
cat("Define the null hypothesis: ", null_hypothesis, "\n")
cat("Define the alternative hypothesis: ", alternative_hypothesis, "\n")
cat("The significance level is: ", significance_level, "\n")


```


> Define the null hypothesis and the alternative hypothesis

> The null hypothesis is ..."The machine is well calibrated."

> The alternative hypothesis is ..."The machine is poorly calibrated."

> The significance level is ... 0.05

>   

## Find the corresponding statistic to the sample 



```{r echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate t-statistic
t_statistic <- (sample_mean - mu) / (sample_sd / sqrt(sample_size))

# Display answers
cat("The statistic follows the t-distribution.\n")
cat("The value of the corresponding statistic is $t = ", t_statistic, "$\n")


```


> The statistic follows the .... t-distribution

> The value of the corresponding statistic is ..*$FORMULA = -3.25$*


## Find the critical value corresponding to the significance level


```{r echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate critical value
critical_value <- qt(1 - significance_level/2, df = sample_size - 1)

# Display answers
cat("The critical value is $t = ", critical_value, "$\n")


```

> The critical value is ..*2.015368*


## Find the p-value


```{r echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate p-value
p_value <- 2 * pt(-abs(t_statistic), df = sample_size - 1)

# Display answers
cat("The p-value is $p = ", p_value, "$\n")


```

> The p-value is ... *$FORMULA = 0.00157508$*


## Make the decision

> I reject the null hypothesis because the... p-value is greater than the significance level.


## Type of errors 


```{r echo=FALSE,eval=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Type of errors
type_i_error <- alpha
type_ii_error <- pt(critical_value, df = sample_size - 1) - pt(-critical_value, df = sample_size - 1)

cat("Type I error: $\\alpha = ", type_i_error, "$\n")
cat("Type II error: $\\beta = ", type_ii_error, "$\n")


```



> The value of Type I error is ...*$FORMULA = 0.05$*


> The value of Type II error is ...*$FORMULA = 0.95$*

\newpage
# List of R commands

> Write here a list of the R commands you have used

# Bibliography

> In case you have used any write it here.
