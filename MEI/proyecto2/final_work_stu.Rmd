---
title: | 
  | SME. Final work 
  |
  | Inferential Statistics.
  |
  | Sampling distributions and confidence intervals
  |
  |
author: '**Name:** Jon Echevarria Sasia '
date: |
  |
  | `r Sys.setlocale("LC_TIME", "C");format(Sys.Date(), "%B %d, %Y")`
  |
  | Table of contents
  |
output:
  pdf_document:
    toc: yes
    toc_depth: '4'
    keep_tex: true
  html_document:
    highlight: espresso
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 4
---




```{r setup, include=FALSE, echo=FALSE}
# setting the options

knitr::opts_chunk$set(echo = TRUE)
options() # printing all current options
options(digits = 2) # number of digits to display

library(moments)   # needed for finding the third and fourth  moments
# Intall if not already installed

```

>     

  
\newpage

# Introduction

> In this laboratory you will have a statement and you have to solve it using R, Rmarkdown and LaTeX. 

> All the necessary formulas will we written in LaTeX. And the answers will written using the R and Rmarkdown commands required. *$(FORMULA = OUTPUT\  FROM\  CODE)$*

> You have to follow the index given and add the explanations required.

\vspace{2cm}

# The statement

> An industrial engineer has designed a machine to pack three-pound potato bags.
However, due to various reasons, such as different weights of potatoes,
filling problems, etc. is aware that the final weight of the potato bag won`t 
be exactly three kilos, but there will be random variations in this quantity.



\vspace{2cm}

## Read the  data and describe them

> 1. The data of the sample comes in the following file: *potato_bags.csv*


```{r, eval=TRUE,echo=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.

# Read the data
fileName <- "potato_bags.csv"
DataX <- read.table(fileName, header = TRUE, col.names = c("X.sample"))

# Number of observations
num_observations <- nrow(DataX)

# Number of variables
num_variables <- ncol(DataX)

```

**QUESTIONS**

> How many data are in the fille?
45
> How many variables? 
1
>  


> 2. Find the mean, variance, standard deviation of the data in the sample

>   


```{r echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Find the mean, variance, standard deviation of the data in the sample
mean_X <- mean(DataX$X.sample)
variance_X <- var(DataX$X.sample)
std_dev_X <- sd(DataX$X.sample)

```


The mean of the sample is $\bar{x} = \frac{\sum_{i=1}^{n}{X_i}}{n} = 3.08$,

the variance is $\sigma^{2} = \frac{1}{n}\sum_{i=1}^{n}{(x_i - \mu)^2} = 0.037$,

and the standard deviation is $\sigma = \sqrt{Var(x)} = 0.18$.

>    

> 3. Draw the histogram of the data showing the density not the frequencies.

```{r echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Draw the histogram of the data showing the density not the frequencies.
hist(DataX$X.sample, prob = TRUE, col = "lightblue", main = "Histogram of Potato Bag Weights", xlab = "Weight")
# lines(density(DataX$X.sample), col = "red", lwd = 2)

```


\newpage

# Sampling distribution of the Sample Mean $X_{n}$


> Find the expected value of the Sample Mean and its standard error.

```{r echo=FALSE,eval=TRUE}

mean_sample_mean <- mean_X
se_sample_mean <- std_dev_X / sqrt(num_observations)

```

$E[X_{n}] = \sum_{i=1}^{n}{x_i * P(x_i)} = 3.08$


and standard error $SD(X_{n}) = \sqrt{Var(x)} = 0.03$ 

\vspace{2cm}

> Which distribution follows the Sample Mean and why? 

**ANSWER:**  
\vspace{2cm}
>The sampling distribution of the sample mean follows a normal distribution. This is based on the Central Limit Theorem, which states that the distribution of the sample mean approaches a normal distribution as the sample size increases.

\vspace{2cm}

> Draw the curve supposing the original population has mean $\mu = 3$ and $\sigma = 0.2$.  





```{r echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Draw the curve supposing the original population has mean μ = 3 and σ = 0.2.
mu <- 3
sigma <- 0.2
x <- seq(mu - 3*sigma, mu + 3*sigma, length.out = 100)
y <- dnorm(x, mean = mu, sd = sigma)

plot(x, y, type = "l", col = "blue", lwd = 2, xlab = "Weight", ylab = "Density", main = "Sampling Distribution of the Sample Mean")


```

\newpage
# Confidence interval for the mean
>1. Which distribution do you use for finding the probability of the confidence interval? Write the  formula for the scores.

**ANSWER:**  
\vspace{2cm}
We use the t-distribution to find the probability of the confidence interval. The formula for the t-scores is:

$t = \frac{\bar{x}-\mu}{\frac{s}{\sqrt{n}}}$



>2. Find the corresponding quantiles using that distribution.


**ANSWER:** 
\vspace{2cm}

```{r, eval=TRUE,echo=FALSE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate quantiles
confidence_level <- 0.95
alpha <- 1 - confidence_level
q <- qt(1 - alpha/2, df = num_observations - 1)

```


>The value of the quantile corresponding to the significance level is $q =2.015368$

> 3. And draw it in the graphic of the distribution.


```{r, echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Draw the distribution with the confidence interval
x <- seq(mu - 3*sigma, mu + 3*sigma, length.out = 100)
y <- dt(x, df = num_observations - 1)

# Draw the histogram of the data showing the density not the frequencies.
hist(DataX$X.sample, prob = TRUE, col = "lightblue", main = "Histogram of Potato Bag Weights", xlab = "Weight")

```





\vspace{2cm}
>3. Find the margin of error and the bounds of the interval.

**ANSWER:** 
\vspace{2cm}

```{r echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate margin of error and interval bounds
margin_of_error <- q * se_sample_mean
lower_bound <- mean_sample_mean - margin_of_error
upper_bound <- mean_sample_mean + margin_of_error

```


> The margin of error is $0.058$

> The bounds of the interval for the mean: $(3 , 3.2)$

\newpage
# Test the following hypothesis

> To check if the machine is well calibrated, take a sample of 45 bags filled with potatoes and count their weight. With this information, 

>> Does the engineer have reason to think the machine is poorly calibrated? (Please use 5% signication level).


## Design the test 


```{r echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Design the hypothesis test
sample_size <- 45
sample_mean <- mean(DataX$X.sample)
sample_sd <- sd(DataX$X.sample)

# Define hypotheses
null_hypothesis <- "The machine is well calibrated."
alternative_hypothesis <- "The machine is poorly calibrated."
significance_level <- 0.05

```


> Define the null hypothesis and the alternative hypothesis

> The null hypothesis is ..."The machine is well calibrated."

> The alternative hypothesis is ..."The machine is poorly calibrated."

> The significance level is ... 0.05

>   

## Find the corresponding statistic to the sample 



```{r echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate t-statistic
t_statistic <- (sample_mean - mu) / (sample_sd / sqrt(sample_size))

```


> The statistic follows the .... t-distribution

> The value of the corresponding statistic is ..*$FORMULA = 3.4$*


## Find the critical value corresponding to the significance level


```{r echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate critical value
critical_value <- qt(1 - significance_level/2, df = sample_size - 1)

```

> The critical value is ..*2.015368*


## Find the p-value


```{r echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Calculate p-value
p_value <- 2 * pt(-abs(t_statistic), df = sample_size - 1)

```

> The p-value is ... *$P(T >= t | H_0) = 0.00157508$*


## Make the decision

> I reject the null hypothesis because the... p-value is less than the significance level.


## Type of errors 


```{r echo=FALSE,eval=TRUE}
# WRITE YOUR CODE HERE, DON´T FORGET TO CHANGE eval = TRUE when you want to compile the document.
# Type of errors
type_i_error <- alpha
type_ii_error <- pt(critical_value, df = sample_size - 1) - pt(-critical_value, df = sample_size - 1)

```



> The value of Type I error is ...*$FORMULA = 0.05$*


> The value of Type II error is ...*$FORMULA = 0.95$*